<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Card Recognition Trainer</title>
    
    <!-- iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Card Trainer">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#1a1a1a">
    
    <!-- PWA -->
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/icon-192.png">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Exit focus mode button -->
    <button id="exit-focus-btn" class="exit-focus-btn" aria-label="Wyjd≈∫ z trybu skupienia">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
    </button>
    
    <div class="app-wrapper">
        <div class="main-container">
            <h1>Trener Szybkiego Rozpoznawania Kart</h1>
            
            
            <div class="card-container">
                <div id="card" class="card hidden">
                    <div class="card-inner">
                        <span id="card-value"></span>
                        <span id="card-suit"></span>
                    </div>
                </div>
                
                <div id="start-screen" class="start-screen">
                    <h2>Przygotuj siƒô!</h2>
                    <p class="mobile-instruction">Dotknij aby rozpoczƒÖƒá</p>
                    <p class="desktop-instruction">Naci≈õnij <strong>SPACJƒò</strong> aby rozpoczƒÖƒá</p>
                    <button id="start-tap-btn" class="tap-button">TAP TO START</button>
                    <p class="instructions mobile-instruction">Gdy pojawi siƒô karta, dotknij ekranu aby przej≈õƒá do nastƒôpnej</p>
                    <p class="instructions desktop-instruction">Gdy pojawi siƒô karta, naci≈õnij <strong>SPACJƒò</strong> aby przej≈õƒá do nastƒôpnej</p>
                </div>
                
                <div id="finish-screen" class="finish-screen hidden">
                    <h2>Sesja zako≈Ñczona!</h2>
                    <div class="final-stats">
                        <p>≈ÅƒÖczny czas: <span id="final-total">0.00</span>s</p>
                        <p>≈öredni czas: <span id="final-average">0.00</span>s</p>
                        <p>Najlepszy czas: <span id="final-best">0.00</span>s</p>
                        <p>Najgorszy czas: <span id="final-worst">0.00</span>s</p>
                    </div>
                    <button id="show-session-chart-btn" class="show-chart-btn">Poka≈º wykres</button>
                    <button id="export-btn" class="export-btn">Eksportuj wyniki</button>
                    <button id="restart-btn" class="restart-btn">Nowa sesja</button>
                </div>
            </div>
            
            <div class="progress-container">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
            </div>
            
            <div class="controls">
                <div class="control-group">
                    <label for="cards-count">Liczba kart: <span id="cards-count-value">10</span></label>
                    <input type="range" id="cards-count" min="1" max="52" value="10">
                </div>
                
                <div class="control-group suits-selection">
                    <label>Wybierz kolory kart:</label>
                    <div class="suits-checkboxes">
                        <label class="suit-checkbox">
                            <input type="checkbox" id="spades" value="‚ô†" checked>
                            <span class="suit-label black">‚ô† Pik</span>
                        </label>
                        <label class="suit-checkbox">
                            <input type="checkbox" id="hearts" value="‚ô•" checked>
                            <span class="suit-label red">‚ô• Kier</span>
                        </label>
                        <label class="suit-checkbox">
                            <input type="checkbox" id="diamonds" value="‚ô¶" checked>
                            <span class="suit-label red">‚ô¶ Karo</span>
                        </label>
                        <label class="suit-checkbox">
                            <input type="checkbox" id="clubs" value="‚ô£" checked>
                            <span class="suit-label black">‚ô£ Trefl</span>
                        </label>
                    </div>
                </div>
                
                <div class="info">
                    <p>Karta: <span id="current-card-number">0</span> / <span id="total-cards">10</span></p>
                </div>
                
                <div class="control-group focus-mode-control">
                    <label for="focus-mode-toggle" class="focus-mode-label">
                        <input type="checkbox" id="focus-mode-toggle">
                        <span>Tryb skupienia</span>
                    </label>
                </div>
            </div>
        </div>
        
        <!-- Panel statystyk -->
        <div class="stats-panel">
            <div class="panel-tabs">
                <button class="tab-button active" data-tab="current">Bie≈ºƒÖca sesja</button>
                <button class="tab-button" data-tab="history">Historia</button>
            </div>
            
            <div id="current-tab" class="tab-content active">
                <h2>Statystyki bie≈ºƒÖcej sesji</h2>
                
                <div class="current-stats">
                    <div class="stat-item">
                        <span class="stat-label">≈ÅƒÖczny czas:</span>
                        <span class="stat-value" id="total-time">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">≈öredni czas:</span>
                        <span class="stat-value" id="average-time">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Najlepszy czas:</span>
                        <span class="stat-value" id="best-time">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Najgorszy czas:</span>
                        <span class="stat-value" id="worst-time">-</span>
                    </div>
                </div>
                
                <div class="cards-list-container">
                    <h3>Rozpoznane karty:</h3>
                    <div id="cards-list" class="cards-list">
                        <!-- Lista kart bƒôdzie generowana przez JavaScript -->
                    </div>
                </div>
                
                <div class="keyboard-hints desktop-only">
                    <h3>Skr√≥ty klawiszowe:</h3>
                    <p><kbd>SPACJA</kbd> - Nastƒôpna karta / Start</p>
                    <p><kbd>ESC</kbd> - Przerwij sesjƒô</p>
                </div>
                
                <div class="touch-hints mobile-only">
                    <h3>Sterowanie:</h3>
                    <p>üëÜ Dotknij ekranu - Nastƒôpna karta</p>
                    <p>üì± Dotknij przycisku TAP - Start</p>
                </div>
            </div>
            
            <div id="history-tab" class="tab-content">
                <h2>Historia sesji</h2>
                
                <div class="history-controls">
                    <button id="export-all-btn" class="history-btn">Eksportuj wszystkie</button>
                    <div class="export-dropdown-container">
                        <button id="export-last-btn" class="history-btn">Eksportuj ostatnie ‚ñº</button>
                        <div id="export-dropdown" class="export-dropdown hidden">
                            <button class="export-option" onclick="exportLastSessions(5)">Ostatnie 5 sesji</button>
                            <button class="export-option" onclick="exportLastSessions(10)">Ostatnie 10 sesji</button>
                            <button class="export-option" onclick="exportLastSessions(15)">Ostatnie 15 sesji</button>
                            <button class="export-option" onclick="exportLastSessions(20)">Ostatnie 20 sesji</button>
                        </div>
                    </div>
                    <button id="show-chart-btn" class="history-btn">Poka≈º wykres postƒôpu</button>
                    <button id="reset-history-btn" class="history-btn danger">Resetuj historiƒô</button>
                </div>
                
                <div id="sessions-history" class="sessions-history">
                    <!-- Historia sesji bƒôdzie generowana przez JavaScript -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal for progress chart -->
    <div id="chart-modal" class="chart-modal hidden">
        <div class="chart-modal-content">
            <div class="chart-modal-header">
                <h2>Postƒôp w rozpoznawaniu kart - ≈õredni czas na kartƒô w ka≈ºdej sesji</h2>
                <div class="chart-controls">
                    <label class="chart-checkbox">
                        <input type="checkbox" id="full-deck-filter">
                        <span>Poka≈º tylko pe≈Çne talie (52 karty)</span>
                    </label>
                    <div class="session-length-filter">
                        <label>Sesje od <span id="session-length-min-value">1</span> do <span id="session-length-max-value">52</span> kart</label>
                        <div class="range-sliders">
                            <input type="range" id="session-length-min-slider" min="1" max="52" value="1" class="min-slider">
                            <input type="range" id="session-length-max-slider" min="1" max="52" value="52" class="max-slider">
                        </div>
                    </div>
                    <button id="close-chart-btn" class="close-chart-btn">&times;</button>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="progress-chart"></canvas>
            </div>
        </div>
    </div>
    
    <!-- Modal for session chart -->
    <div id="session-chart-modal" class="chart-modal hidden">
        <div class="chart-modal-content">
            <div class="chart-modal-header">
                <h2>Czas rozpoznania ka≈ºdej karty</h2>
                <button id="close-session-chart-btn" class="close-chart-btn">&times;</button>
            </div>
            <div class="chart-container">
                <canvas id="session-chart"></canvas>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js"></script>
</body>
</html>